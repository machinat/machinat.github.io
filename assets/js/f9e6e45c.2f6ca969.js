"use strict";(self.webpackChunkmachinat_github_io=self.webpackChunkmachinat_github_io||[]).push([[5729],{3905:function(e,n,t){t.d(n,{Zo:function(){return m},kt:function(){return c}});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},m=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=s(t),c=l,k=d["".concat(p,".").concat(c)]||d[c]||u[c]||r;return t?a.createElement(k,i(i({ref:n},m),{},{components:t})):a.createElement(k,i({ref:n},m))}));function c(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=d;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:l,i[1]=o;for(var s=2;s<r;s++)i[s]=t[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},9715:function(e,n,t){t.r(n),t.d(n,{assets:function(){return m},contentTitle:function(){return p},default:function(){return c},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return u}});var a=t(7462),l=t(3366),r=(t(7294),t(3905)),i=["components"],o={title:"Rendering Messages"},p=void 0,s={unversionedId:"rendering-messages",id:"rendering-messages",title:"Rendering Messages",description:"The expression in JSX will be rendered into the messages to be sent.",source:"@site/docs/rendering-messages.md",sourceDirName:".",slug:"/rendering-messages",permalink:"/docs/rendering-messages",draft:!1,editUrl:"https://github.com/machinat/machinat/edit/master/website/docs/rendering-messages.md",tags:[],version:"current",frontMatter:{title:"Rendering Messages"},sidebar:"docs",previous:{title:"Introducing JSX",permalink:"/docs/introducing-jsx"},next:{title:"Components for Chat UI",permalink:"/docs/components-for-cui"}},m={},u=[{value:"Sending Text",id:"sending-text",level:3},{value:"The General Element Tags",id:"the-general-element-tags",level:3},{value:"Textual element types:",id:"textual-element-types",level:5},{value:"Non-textual element types:",id:"non-textual-element-types",level:5},{value:"Textual Element",id:"textual-element",level:3},{value:"Fragment",id:"fragment",level:3},{value:"Native Component",id:"native-component",level:3},{value:"Pause",id:"pause",level:3}],d={toc:u};function c(e){var n=e.components,t=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The expression in JSX will be rendered into the messages to be sent.\nOnce you describe the JSX view, Machinat would handle all the works behind."),(0,r.kt)("p",null,"Typically there are two ways to render the messages: ",(0,r.kt)("inlineCode",{parentName:"p"},"reply")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"bot.render"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"app.onEvent(async ({ event, bot, reply }) => {\n  await reply(<p>Hello World</p>);\n  // is the same as\n  await bot.render(event.channel, <p>Hello World</p>);\n});\n")),(0,r.kt)("h3",{id:"sending-text"},"Sending Text"),(0,r.kt)("p",null,"Rendering a string is the easiest way to send a message:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"await bot.render(channel, 'hello world');\n")),(0,r.kt)("p",null,"This is supported by all the platforms."),(0,r.kt)("h3",{id:"the-general-element-tags"},"The General Element Tags"),(0,r.kt)("p",null,"The JSX elements with an uncapitalized tag are ",(0,r.kt)("em",{parentName:"p"},"general")," elements, like ",(0,r.kt)("inlineCode",{parentName:"p"},"<p></p>"),".\nThey can be rendered onto all the platforms,\nso you can use them to make cross-platform UI easily."),(0,r.kt)("p",null,"The supported element tags and their props are listed below:"),(0,r.kt)("h5",{id:"textual-element-types"},"Textual element types:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"b")," - render children bold.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"i")," - render children italic.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"s")," - render the children with strikethrough.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"s")," - render the children with underline.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"code")," - render children as monospaced.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"pre")," - render children as preformatted."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"br")," - add a line break."))),(0,r.kt)("h5",{id:"non-textual-element-types"},"Non-textual element types:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"p")," - send a text message bubble."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"children")," - textual content."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"img")," - send an image message."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src")," - image URL.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"audio")," - send an audio message.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src")," - audio URL.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"video")," - send a video message.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src")," - video URL.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"file")," - send a file message.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"src")," - file URL.")))),(0,r.kt)("h3",{id:"textual-element"},"Textual Element"),(0,r.kt)("p",null,"Some element types are ",(0,r.kt)("em",{parentName:"p"},"textual"),",\nwhich means they're equivalent to pure text in JSX.\nSome element accept only textual content as prop,\nlike ",(0,r.kt)("inlineCode",{parentName:"p"},"<p></p>"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"await bot.render(\n  channel,\n  <p>foo <b>bar</b> <i>baz</i></p>\n);\n")),(0,r.kt)("h3",{id:"fragment"},"Fragment"),(0,r.kt)("p",null,"You may need to send a collection of messages at a time.\nTo do this, wrap the messages in a ",(0,r.kt)("inlineCode",{parentName:"p"},"<>...</>")," element, like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'await bot.render(\n  channel,\n  <>\n    <p>Look at the kitten!</p>\n    <img src="http://..." />\n    <p>Aww I\'m melting!</p>\n  </>\n);\n')),(0,r.kt)("p",null,"The element with an empty tag is a ",(0,r.kt)("em",{parentName:"p"},"fragment"),".\nWhen you ",(0,r.kt)("inlineCode",{parentName:"p"},"render")," a fragment, all the messages inside will be sent in order.\nAll the sending jobs are handled by the framework,\nso you only have to focus on UI."),(0,r.kt)("h3",{id:"native-component"},"Native Component"),(0,r.kt)("p",null,"The general tags provide a set of cross-platform APIs.\nBut you might want to use more special features on a particular platform."),(0,r.kt)("p",null,"These platform-specific features are available as ",(0,r.kt)("strong",{parentName:"p"},"Native Components"),".\nYou can require them from platform packages and use them like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import * as Messenger from \'@machinat/messenger/components\'\n\nawait bot.render(\n  channel,\n  <Messenger.MediaTemplate\n    type="video"\n    url="http://..."\n    buttons={\n      <Messenger.UrlButton title="Go" url="http://..."/>\n    }\n  />\n);\n')),(0,r.kt)("p",null,"You should only use the native components corresponding to the platform.\nIf you're making a cross-platform UI,\nyou can check ",(0,r.kt)("inlineCode",{parentName:"p"},"context.platform")," and choose the native component to use.\nLike:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'app.onEvent(async ({ platform, reply }) => {\n  await reply(\n    <>\n      Hi!\n      {platform === \'messenger\'\n        ? <Messenger.Image url="..." />\n        : platform === \'telegram\'\n        ? <Telegram.Photo url="..." />\n        : <img src="..." />}\n    </>\n  );\n});\n')),(0,r.kt)("h3",{id:"pause"},"Pause"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Machinat.Pause")," adds a pause between messages.\nFor example, ",(0,r.kt)("inlineCode",{parentName:"p"},"<Machinat.Pause time={1000}/>")," element delays all the messages after it by 1000 ms."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"await bot.render(channel,\n  <>\n    1\n    <Machinat.Pause time={1000} />\n    2\n    <Machinat.Pause time={1000} />\n    3\n    <Machinat.Pause time={1000} />\n    Red light!\n  </>\n);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"delay")," prop can also be used to measure the pause time.\nIt accepts an async function, and the messages afterwards are delayed till the returned promise is resolved.\nFor example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function waitForSomething() {\n  await doSomething();\n}\n\nbot.render(channel,\n  <>\n    hello\n    <Machinat.Pause delay={waitForSomething} />\n    world\n  </>\n);\n")))}c.isMDXComponent=!0}}]);